<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="description" content="">
    <meta name="keywords" content="">

    <!-- Base Css Files -->
    <link href="/static/admin/assets/libs/jqueryui/ui-lightness/jquery-ui-1.10.4.custom.min.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/font-awesome/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/fontello/css/fontello.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/animate-css/animate.min.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/nifty-modal/css/component.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/magnific-popup/magnific-popup.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/ios7-switch/ios7-switch.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/pace/pace.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/sortable/sortable-theme-bootstrap.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/bootstrap-datepicker/css/datepicker.css" rel="stylesheet"/>
    <link href="/static/admin/assets/libs/jquery-icheck/skins/all.css" rel="stylesheet"/>
    <!-- Code Highlighter for Demo -->
    <link href="/static/admin/assets/libs/prettify/github.css" rel="stylesheet"/>

    <!-- Extra CSS Libraries Start -->
    <link href="/static/admin/assets/css/style.css" rel="stylesheet" type="text/css"/>
    <!-- Extra CSS Libraries End -->
    <link href="/static/admin/assets/css/style-responsive.css" rel="stylesheet"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="/static/admin/assets/js/html5shiv.js"></script>
    <script src="/static/admin/assets/js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="/static/admin/assets/img/favicon.ico">
    <script src="/static/admin/assets/js/toastr.min.js"></script>
</head>
<body class="fixed-left login-page">
<!-- Modal Start -->
<!-- Modal Task Progress -->
<div class="md-modal md-3d-flip-vertical" id="task-progress">
    <div class="md-content">
        <h3><strong>Task Progress</strong> Information</h3>
        <div>
            <p>CLEANING BUGS</p>
            <div class="progress progress-xs for-modal">
                <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="80" aria-valuemin="0"
                     aria-valuemax="100" style="width: 80%">
                    <span class="sr-only">80&#37; Complete</span>
                </div>
            </div>
            <p>POSTING SOME STUFF</p>
            <div class="progress progress-xs for-modal">
                <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="80" aria-valuemin="0"
                     aria-valuemax="100" style="width: 65%">
                    <span class="sr-only">65&#37; Complete</span>
                </div>
            </div>
            <p>BACKUP DATA FROM SERVER</p>
            <div class="progress progress-xs for-modal">
                <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="80" aria-valuemin="0"
                     aria-valuemax="100" style="width: 95%">
                    <span class="sr-only">95&#37; Complete</span>
                </div>
            </div>
            <p>RE-DESIGNING WEB APPLICATION</p>
            <div class="progress progress-xs for-modal">
                <div class="progress-bar progress-bar-primary" role="progressbar" aria-valuenow="80" aria-valuemin="0"
                     aria-valuemax="100" style="width: 100%">
                    <span class="sr-only">100&#37; Complete</span>
                </div>
            </div>
            <p class="text-center">
                <button class="btn btn-danger btn-sm md-close">Close</button>
            </p>
        </div>
    </div>
</div>

<!-- Modal Logout -->
<div class="md-modal md-just-me" id="logout-modal">
    <div class="md-content">
        <h3><strong>Logout</strong> Confirmation</h3>
        <div>
            <p class="text-center">Are you sure want to logout from this awesome system?</p>
            <p class="text-center">
                <button class="btn btn-danger md-close">Nope!</button>
                <a href="{}" class="btn btn-success md-close">Yeah, I'm sure</a>
            </p>
        </div>
    </div>
</div>        <!-- Modal End -->
<!-- Begin page -->
<div class="container">
    <div class="full-content-center">
        <p class="text-center"><a href="#"><img src="/static/admin/assets/img/login-logo.png" alt="Logo"></a></p>
        <div class="login-wrap animated flipInX">
            <div class="login-block">
                <img src="/static/index/face/batman.jpg" class="img-circle not-logged-avatar">
                    <form id="my" name="regForm" role="form" action="{:url('index/login/login')}" method="post">
                        <div class="form-group login-input">
                            <i class="fa fa-user overlay"></i>
                            <input type="text" class="form-control text-input name" placeholder="账号" name="name" data-id="1">
                        </div>
                        <div class="form-group login-input">
                            <i class="fa fa-key overlay"></i>
                            <input type="tel" class="form-control text-input tel" placeholder="手机号码" name="tel" data-id="1">
                        </div>
                         <div class="btn btn-default send">获取验证码</a>
                         </div>
                          &nbsp;&nbsp;&nbsp;&nbsp;
                        <input type="text" name="msg1" class="tttt" placeholder="输入验证码" style="color:black" data-id="111111">
                        <div class="a" style="height:7px">
                            
                        </div>
                        <p style="float:left" id="tab">
                            
                        </p>
                        
                        <div class="row">
                            <div class="col-sm-12">
                                <buttons type="submit" class="btn btn-success btn-block login">确认提交
                                </buttons>
                            </div>
                        </div>
                        
                    </form>
            </div>
        </div>

    </div>
</div>




<!-- the overlay modal element -->
<div class="md-overlay"></div>
<!-- End of eoverlay modal -->
{js href="/static/admin/assets/js/jquery.min.js"}
{js href="/static/index/js/bootstrap.min.js"}
<script>
    // 判断用户名是否存在
    $(function(){
        $('.name').blur(function(){
            var name = $('.name').val();
            var tab = document.getElementById('tab');
            if(name == ''){
                tab.innerHTML = '* 用户名不能为空！';
                exit;
            }
            $.ajax({
                type : 'get',
                url : '/findname/',
                data : {name:name},
                datatype : 'json',
                success : function(data){
                  if(data['status']){
                    $('.name').attr('data-id','0');
                    tab.innerHTML = '* 该用户名可以正常使用！';
                  }else{
                    tab.innerHTML = '* 该用户名不存在,请先注册!';
                  }
                },
                error : function() {
                    alert('找回密码失败!');
                }
            });
        });
    });
    // 判断电话是否存在
    $(function(){
        $('.tel').blur(function(){
            var tel = $('.tel').val();
            var tab = document.getElementById('tab');
            if (tel == '') {
                    tab.innerHTML = '* 必填项,请输入您的手机号';
                    exit;
            }
            if (tel.match(/^1[34578]\d{9}$/) == null) {
                    tab.innerHTML = '* 手机号格式不正确!';
                    exit;
            }
            $.ajax({
                type : 'get',
                url : '/findtel/',
                data : {tel:tel},
                datatype : 'json',
                success : function(data){
                  if(data['status']){
                    $('.tel').attr('data-id','0');
                    tab.innerHTML = '* 该手机可以正常使用！';
                  }else{
                    tab.innerHTML = '* 该手机不存在,请先注册!';
                  }
                },
                error : function() {
                    alert('找回密码失败!');
                }
            });
        });
    });
    // 发送电话验证码
        $(function(){
            $('.send').click(function(){
                var tel = $('.tel').val();
                gettelAjax(tel);
            });
        });
        function gettelAjax(tel) {
            $.ajax({
                type: 'get',
                url: '/sendtel/',
                dataType : 'json',
                data: {tel:tel},
                success : function (data){
                    if(data.status){
                        alert('验证码发送成功');
                    }else{
                        alert('验证码发送失败,请稍后再试!');
                    }
                },
                error : function () {
                    alert('验证码发送失败,请稍后再试!');
                }
            });
        }
// 验证电话验证码
        $(function(){
            $('.tttt').blur(function(){
                var ttt = $('.tttt').val();
                if(ttt == ''){
                    tab.innerHTML = '* 请输入手机验证码';
                    exit;
                }  
                var tab = document.getElementById('tab');
                $.ajax({
                    type: 'get',
                    url: '/composer/',
                    dataType : 'json',
                    data: {ttt:ttt},
                    success : function (data){
                        if(data['status']){
                            tab.innerHTML = '* 验证码输入正确!';
                            $('.tttt').attr('data-id','0');
                        }else{
                            tab.innerHTML = '* 验证码输入错误!';
                        }
                    },
                    error : function(){
                        alert('验证码错误');
                    }
                });
            });
        });
// 提交
        $(function(){
            $('.login').click(function(){
                var tel = $('.tel').val();
                var aa = $('.name').attr('data-id');
                var bb = $('.tel').attr('data-id');
                var cc = $('.tttt').attr('data-id');
                $.ajax({
                    type : 'get',
                    url : '/changepwd/',
                    datatype : 'json',
                    data : {tel:tel},
                    success : function(data){
                        if(data.status){
                            if( aa == 0 && bb == 0 && cc == 0 ){
                                alert('验证成功！请更改密码');
                                window.location.href = "/returnpass/"+tel;
                             }else{
                                alert('验证失败了,请认真填写信息!');
                             }
                        }
                        
                    },
                    error : function(){
                        alert('注册失败1,请稍后再试');
                    }
                });
            });
        });



</script>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->

<script src="/static/admin/assets/libs/bootstrap/js/bootstrap.min.js"></script>
<script src="/static/admin/assets/libs/jqueryui/jquery-ui-1.10.4.custom.min.js"></script>
<script src="/static/admin/assets/libs/jquery-ui-touch/jquery.ui.touch-punch.min.js"></script>
<script src="/static/admin/assets/libs/jquery-detectmobile/detect.js"></script>
<script src="/static/admin/assets/libs/jquery-animate-numbers/jquery.animateNumbers.js"></script>
<script src="/static/admin/assets/libs/ios7-switch/ios7.switch.js"></script>
<script src="/static/admin/assets/libs/fastclick/fastclick.js"></script>
<script src="/static/admin/assets/libs/jquery-blockui/jquery.blockUI.js"></script>
<script src="/static/admin/assets/libs/bootstrap-bootbox/bootbox.min.js"></script>
<script src="/static/admin/assets/libs/jquery-slimscroll/jquery.slimscroll.js"></script>
<script src="/static/admin/assets/libs/jquery-sparkline/jquery-sparkline.js"></script>
<script src="/static/admin/assets/libs/nifty-modal/js/classie.js"></script>
<script src="/static/admin/assets/libs/nifty-modal/js/modalEffects.js"></script>
<script src="/static/admin/assets/libs/sortable/sortable.min.js"></script>
<script src="/static/admin/assets/libs/bootstrap-fileinput/bootstrap.file-input.js"></script>
<script src="/static/admin/assets/libs/bootstrap-select/bootstrap-select.min.js"></script>
<script src="/static/admin/assets/libs/bootstrap-select2/select2.min.js"></script>
<script src="/static/admin/assets/libs/magnific-popup/jquery.magnific-popup.min.js"></script>
<script src="/static/admin/assets/libs/pace/pace.min.js"></script>
<script src="/static/admin/assets/libs/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script src="/static/admin/assets/libs/jquery-icheck/icheck.min.js"></script>

<!-- Demo Specific JS Libraries -->
<script src="/static/admin/assets/libs/prettify/prettify.js"></script>

<script src="/static/admin/assets/js/init.js"></script>
</body>
</html>